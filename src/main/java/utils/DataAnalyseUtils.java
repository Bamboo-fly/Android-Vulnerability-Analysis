package utils;

import java.io.*;
import java.util.*;

public class DataAnalyseUtils {

    private  static List<String> quanxian=new ArrayList<>();

    private static List<String> loudong=new ArrayList<>();

    //获取危险权限方法
    public static List<String> dangerous(String apkpath) throws IOException {
        ArrayList<String> list = ApkUtils.getData(apkpath);
        String AndroidMainXml = list.get(5);
        String str = "src/main/resources/com/example/androidtest/危险权限.txt";

        FileInputStream fin = new FileInputStream(str);
        InputStreamReader reader = new InputStreamReader(fin);
        BufferedReader buffReader = new BufferedReader(reader);
        String strTmp = "";
        while((strTmp = buffReader.readLine())!=null){
            List<String> list3 = Arrays.asList(strTmp.split(" "));
            for (int i=0;i<list3.size();i++){
                if ( AndroidMainXml.contains(list3.get(i))){
                    System.out.print(list3.get(0)+": ");
                    System.out.println(list3.get(i));
                    quanxian.add(list3.get(0)+": "+list3.get(i));
                }
            }
        }
        buffReader.close();

        return quanxian;
    }

    //其他漏洞
    public static List<String> loudong(String apkpath) throws IOException {
        ArrayList<String> list = ApkUtils.getData(apkpath);
        String AndroidMainXml = list.get(5);
        String str = "src/main/resources/com/example/androidtest/漏洞.txt";

        FileInputStream fin = new FileInputStream(str);
        InputStreamReader reader = new InputStreamReader(fin);
        BufferedReader buffReader = new BufferedReader(reader);
        String strTmp = "";
        while((strTmp = buffReader.readLine())!=null){
            List<String> list3 = Arrays.asList(strTmp.split(" "));
            for (int i=0;i<list3.size();i++){
                if ( AndroidMainXml.contains(list3.get(i))){
                    System.out.print(list3.get(0)+": ");
                    System.out.println(list3.get(i));
                    loudong.add(list3.get(0)+": "+list3.get(1));
                }
            }
        }
        buffReader.close();

        return loudong;
    }

}
